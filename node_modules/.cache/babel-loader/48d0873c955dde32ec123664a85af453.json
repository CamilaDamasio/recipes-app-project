{"ast":null,"code":"var _jsxFileName = \"/home/camila/Documentos/github_projetos/recipes-app-project/src/pages/DrinksInProgress.jsx\";\nimport React, { useState, useEffect } from 'react';\nimport { useParams, Redirect } from 'react-router-dom';\nimport { Button, Form } from 'react-bootstrap';\nimport ShareBtn from '../components/ShareBtn';\nimport whiteHeartIcon from \"../images/whiteHeartIcon.svg\";\nimport blackHeartIcon from \"../images/blackHeartIcon.svg\";\nimport { drinkById } from '../utils/fetchAPIbyID';\nimport useRedirect from '../hooks/useRedirect';\nimport HeaderWithoutSearch from '../components/HeaderWithoutSearch';\n\nfunction DrinksInProgress() {\n  const {\n    id\n  } = useParams();\n  const [drinkDetails, setDrinkDetails] = useState({});\n  const [progress, setProgress] = useState([]);\n  const {\n    shouldRedirect,\n    redirect\n  } = useRedirect();\n  const [disabled, setDisabled] = useState(true);\n  useEffect(() => {\n    const fetchDrink = async () => {\n      const drink = await drinkById(id);\n      setDrinkDetails(drink);\n      const inProgressRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n\n      if (inProgressRecipes && progress.length === 0 && Object.keys(inProgressRecipes.cocktails).some(key => key === id)) {\n        const {\n          cocktails\n        } = inProgressRecipes;\n        const loadedProgress = cocktails[id];\n        setProgress(loadedProgress);\n        const inputs = document.querySelectorAll('input');\n\n        if (inputs) {\n          inputs.forEach(input => {\n            if (loadedProgress.some(value => value === input.parentElement.querySelector('label').innerText)) {\n              input.defaultChecked = true;\n              input.parentElement.querySelector('label').style.textDecoration = 'line-through';\n            }\n          });\n        }\n      }\n    };\n\n    const favoriteRecipes = JSON.parse(localStorage.getItem('favoriteRecipes'));\n\n    if (favoriteRecipes) {\n      const isFavorite = () => favoriteRecipes.some(recipe => recipe.id === id) && document.getElementById('fav-btn').setAttribute('src', blackHeartIcon);\n\n      isFavorite();\n    }\n\n    fetchDrink();\n  }, [id, progress]);\n  const retObj = Object.entries(drinkDetails);\n  const listIngredients = retObj.filter(drink => drink[0].includes('Ingredient') && drink[1]);\n  const filterAlcoohol = retObj.filter(drink => {\n    const noAlcool = drink[1] !== ' ' && drink[1] !== null;\n    return drink[0].includes('Measure') && noAlcool;\n  });\n\n  const progressRecipe = labelValue => {\n    let updatedProgress = [];\n\n    if (!progress.some(value => value === labelValue)) {\n      updatedProgress = progress.concat(labelValue);\n      setProgress(updatedProgress);\n    } else {\n      updatedProgress = progress.filter(ingredient => ingredient !== labelValue);\n      setProgress(updatedProgress);\n    }\n\n    let inProgressRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n\n    if (!inProgressRecipes) {\n      inProgressRecipes = {\n        cocktails: {\n          [id]: updatedProgress\n        }\n      };\n    } else {\n      let {\n        cocktails\n      } = inProgressRecipes;\n\n      if (inProgressRecipes.cocktails) {\n        cocktails[id] = updatedProgress;\n      } else {\n        const recipeProgress = {\n          [id]: [...updatedProgress]\n        };\n        cocktails = { ...cocktails,\n          ...recipeProgress\n        };\n      }\n\n      inProgressRecipes.cocktails = cocktails;\n    }\n\n    localStorage.setItem('inProgressRecipes', JSON.stringify(inProgressRecipes));\n  };\n\n  const finishRecipe = () => {\n    const {\n      strCategory,\n      strDrinkThumb,\n      strDrink,\n      strTags\n    } = drinkDetails;\n    const d = new Date();\n    const dataDMY = `${d.getDay()}/${d.getMonth()}/${d.getFullYear()}`;\n    const dataTIME = `${d.getHours()}hrs${d.getMinutes()}min`;\n    let arrTag;\n\n    if (strTags) {\n      arrTag = strTags.split(',');\n    } else {\n      arrTag = null;\n    }\n\n    const finishedRecipeToken = {\n      id,\n      type: 'bebida',\n      area: null,\n      category: strCategory,\n      alcoholicOrNot: null,\n      name: strDrink,\n      image: strDrinkThumb,\n      doneDate: `${dataDMY} às ${dataTIME}`,\n      tags: arrTag\n    };\n    const inProgressRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n\n    if ((Object.keys(inProgressRecipes).length && Object.keys(inProgressRecipes.cocktails).length) === 1) {\n      localStorage.removeItem('inProgressRecipes');\n    } else {\n      delete inProgressRecipes.cocktails[id];\n    }\n\n    let doneRecipes = JSON.parse(localStorage.getItem('doneRecipes'));\n\n    if (doneRecipes) {\n      doneRecipes.push(finishedRecipeToken);\n    } else {\n      doneRecipes = [finishedRecipeToken];\n    }\n\n    localStorage.setItem('doneRecipes', JSON.stringify(doneRecipes));\n    shouldRedirect('/receitas-feitas');\n  };\n\n  const isDisabled = () => {\n    const el = document.querySelectorAll('input');\n\n    if (!Array.from(el).every(x => x.checked)) {\n      setDisabled(true);\n    } else {\n      setDisabled(false);\n    }\n  };\n\n  const setFavorite = () => {\n    const {\n      strDrinkThumb,\n      strDrink,\n      strAlcoholic,\n      strCategory\n    } = drinkDetails;\n    const favoriteRecipeToken = {\n      id,\n      type: 'bebida',\n      area: '',\n      category: strCategory,\n      alcoholicOrNot: strAlcoholic,\n      name: strDrink,\n      image: strDrinkThumb\n    };\n    let favoriteRecipes = JSON.parse(localStorage.getItem('favoriteRecipes'));\n\n    if (favoriteRecipes) {\n      if (favoriteRecipes.every(recipe => recipe.id !== favoriteRecipeToken.id)) {\n        favoriteRecipes.push(favoriteRecipeToken);\n        document.getElementById('fav-btn').setAttribute('src', blackHeartIcon);\n      } else {\n        favoriteRecipes = favoriteRecipes.filter(recipe => recipe.id !== favoriteRecipeToken.id);\n        document.getElementById('fav-btn').setAttribute('src', whiteHeartIcon);\n      }\n    } else {\n      favoriteRecipes = [favoriteRecipeToken];\n      document.getElementById('fav-btn').setAttribute('src', blackHeartIcon);\n    }\n\n    localStorage.setItem('favoriteRecipes', JSON.stringify(favoriteRecipes));\n\n    if (Object.values(favoriteRecipes).length === 0) {\n      localStorage.removeItem('favoriteRecipes');\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    onChange: isDisabled,\n    className: \"in-progress\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 5\n    }\n  }, redirect.should && /*#__PURE__*/React.createElement(Redirect, {\n    to: redirect.path,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 28\n    }\n  }), /*#__PURE__*/React.createElement(HeaderWithoutSearch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 7\n    }\n  }, \"Receita em progresso\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"img-ingredients\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: drinkDetails.strDrinkThumb,\n    alt: \"imagem da bebida\",\n    \"data-testid\": \"recipe-photo\",\n    className: \"in-progress-pic\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"recipe-detail\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"detail-card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    \"data-testid\": \"recipe-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 13\n    }\n  }, drinkDetails.strDrink), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"details-btn-div\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ShareBtn, {\n    id: id,\n    type: \"bebida\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    className: \"favorite-btn\",\n    variant: \"danger\",\n    type: \"button\",\n    onClick: setFavorite,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    id: \"fav-btn\",\n    className: \"icon\",\n    src: whiteHeartIcon,\n    alt: \"favoritar\",\n    \"data-testid\": \"favorite-btn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 17\n    }\n  })))), /*#__PURE__*/React.createElement(\"p\", {\n    \"data-testid\": \"recipe-category\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 13\n    }\n  }, \"Categoria: \"), drinkDetails.strAlcoholic), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"list-ingredients\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 13\n    }\n  }, \"Ingredientes\"), /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 13\n    }\n  }, listIngredients.map((ingredient, index) => /*#__PURE__*/React.createElement(\"li\", {\n    key: index,\n    \"data-testid\": `${index}-ingredient-step`,\n    className: \"in-progress-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form.Group, {\n    className: \"mb-3\",\n    controlId: `${index}-ingredient-step`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Form.Check, {\n    type: \"checkbox\",\n    id: `${index}-ingredient-step`,\n    label: filterAlcoohol[index] ? `${ingredient[1]} - ${filterAlcoohol[index][1]}` : ingredient[1],\n    onChange: ({\n      target\n    }) => {\n      const label = target.parentElement;\n      progressRecipe(label.innerText);\n\n      if (target.checked) {\n        label.style.textDecoration = 'line-through';\n      } else if (!target.checked) {\n        target.defaultChecked = false;\n        label.style.textDecoration = 'none';\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 21\n    }\n  })))))))), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 7\n    }\n  }, \"Instru\\xE7\\xF5es: \"), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"instructions\",\n    \"data-testid\": \"instructions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 7\n    }\n  }, drinkDetails.strInstructions), /*#__PURE__*/React.createElement(Button, {\n    disabled: disabled,\n    type: \"button\",\n    \"data-testid\": \"finish-recipe-btn\",\n    className: \"finishRecipe\",\n    onClick: finishRecipe,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 7\n    }\n  }, \"Finalizar Receita\"));\n}\n\nexport default DrinksInProgress;","map":{"version":3,"sources":["/home/camila/Documentos/github_projetos/recipes-app-project/src/pages/DrinksInProgress.jsx"],"names":["React","useState","useEffect","useParams","Redirect","Button","Form","ShareBtn","drinkById","useRedirect","HeaderWithoutSearch","DrinksInProgress","id","drinkDetails","setDrinkDetails","progress","setProgress","shouldRedirect","redirect","disabled","setDisabled","fetchDrink","drink","inProgressRecipes","JSON","parse","localStorage","getItem","length","Object","keys","cocktails","some","key","loadedProgress","inputs","document","querySelectorAll","forEach","input","value","parentElement","querySelector","innerText","defaultChecked","style","textDecoration","favoriteRecipes","isFavorite","recipe","getElementById","setAttribute","blackHeartIcon","retObj","entries","listIngredients","filter","includes","filterAlcoohol","noAlcool","progressRecipe","labelValue","updatedProgress","concat","ingredient","recipeProgress","setItem","stringify","finishRecipe","strCategory","strDrinkThumb","strDrink","strTags","d","Date","dataDMY","getDay","getMonth","getFullYear","dataTIME","getHours","getMinutes","arrTag","split","finishedRecipeToken","type","area","category","alcoholicOrNot","name","image","doneDate","tags","removeItem","doneRecipes","push","isDisabled","el","Array","from","every","x","checked","setFavorite","strAlcoholic","favoriteRecipeToken","whiteHeartIcon","values","should","path","map","index","target","label","strInstructions"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, Redirect } from 'react-router-dom';\nimport { Button, Form } from 'react-bootstrap';\nimport ShareBtn from '../components/ShareBtn';\nimport whiteHeartIcon from '../images/whiteHeartIcon.svg';\nimport blackHeartIcon from '../images/blackHeartIcon.svg';\nimport { drinkById } from '../utils/fetchAPIbyID';\nimport useRedirect from '../hooks/useRedirect';\nimport HeaderWithoutSearch from '../components/HeaderWithoutSearch';\n\nfunction DrinksInProgress() {\n  const { id } = useParams();\n  const [drinkDetails, setDrinkDetails] = useState({});\n  const [progress, setProgress] = useState([]);\n  const { shouldRedirect, redirect } = useRedirect();\n  const [disabled, setDisabled] = useState(true);\n  useEffect(() => {\n    const fetchDrink = async () => {\n      const drink = await drinkById(id);\n      setDrinkDetails(drink);\n      const inProgressRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n      if (inProgressRecipes && progress\n        .length === 0 && Object.keys(inProgressRecipes.cocktails)\n        .some((key) => key === id)) {\n        const { cocktails } = inProgressRecipes;\n        const loadedProgress = cocktails[id];\n        setProgress(loadedProgress);\n        const inputs = document.querySelectorAll('input');\n        if (inputs) {\n          inputs.forEach((input) => {\n            if (loadedProgress.some((value) => value === input.parentElement\n              .querySelector('label').innerText)) {\n              input.defaultChecked = true;\n              input.parentElement\n                .querySelector('label').style.textDecoration = 'line-through';\n            }\n          });\n        }\n      }\n    };\n    const favoriteRecipes = JSON.parse(localStorage.getItem('favoriteRecipes'));\n    if (favoriteRecipes) {\n      const isFavorite = () => favoriteRecipes\n        .some((recipe) => recipe.id === id) && document.getElementById('fav-btn')\n        .setAttribute('src', blackHeartIcon);\n      isFavorite();\n    }\n    fetchDrink();\n  }, [id, progress]);\n\n  const retObj = Object.entries(drinkDetails);\n  const listIngredients = retObj.filter((drink) => (\n    drink[0].includes('Ingredient') && drink[1]\n  ));\n  const filterAlcoohol = retObj.filter((drink) => {\n    const noAlcool = drink[1] !== ' ' && drink[1] !== null;\n    return drink[0].includes('Measure') && noAlcool;\n  });\n\n  const progressRecipe = (labelValue) => {\n    let updatedProgress = [];\n    if (!progress.some((value) => value === labelValue)) {\n      updatedProgress = progress.concat(labelValue);\n      setProgress(updatedProgress);\n    } else {\n      updatedProgress = progress.filter((ingredient) => ingredient !== labelValue);\n      setProgress(updatedProgress);\n    }\n    let inProgressRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n    if (!inProgressRecipes) {\n      inProgressRecipes = {\n        cocktails: { [id]: updatedProgress },\n      };\n    } else {\n      let { cocktails } = inProgressRecipes;\n      if (inProgressRecipes.cocktails) {\n        cocktails[id] = updatedProgress;\n      } else {\n        const recipeProgress = { [id]: [...updatedProgress] };\n        cocktails = { ...cocktails, ...recipeProgress };\n      }\n      inProgressRecipes.cocktails = cocktails;\n    }\n    localStorage.setItem('inProgressRecipes', JSON.stringify(inProgressRecipes));\n  };\n\n  const finishRecipe = () => {\n    const { strCategory, strDrinkThumb, strDrink, strTags } = drinkDetails;\n    const d = new Date();\n    const dataDMY = `${d.getDay()}/${d.getMonth()}/${d.getFullYear()}`;\n    const dataTIME = `${d.getHours()}hrs${d.getMinutes()}min`;\n    let arrTag;\n    if (strTags) {\n      arrTag = strTags.split(',');\n    } else {\n      arrTag = null;\n    }\n    const finishedRecipeToken = {\n      id,\n      type: 'bebida',\n      area: null,\n      category: strCategory,\n      alcoholicOrNot: null,\n      name: strDrink,\n      image: strDrinkThumb,\n      doneDate: `${dataDMY} às ${dataTIME}`,\n      tags: arrTag,\n    };\n    const inProgressRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n    if ((Object.keys(inProgressRecipes)\n      .length && Object.keys(inProgressRecipes.cocktails).length) === 1) {\n      localStorage.removeItem('inProgressRecipes');\n    } else {\n      delete inProgressRecipes.cocktails[id];\n    }\n    let doneRecipes = JSON.parse(localStorage.getItem('doneRecipes'));\n    if (doneRecipes) {\n      doneRecipes.push(finishedRecipeToken);\n    } else {\n      doneRecipes = [finishedRecipeToken];\n    }\n    localStorage.setItem('doneRecipes', JSON.stringify(doneRecipes));\n    shouldRedirect('/receitas-feitas');\n  };\n\n  const isDisabled = () => {\n    const el = document.querySelectorAll('input');\n    if (!(Array.from(el).every((x) => x.checked))) {\n      setDisabled(true);\n    } else {\n      setDisabled(false);\n    }\n  };\n  const setFavorite = () => {\n    const { strDrinkThumb, strDrink, strAlcoholic, strCategory } = drinkDetails;\n    const favoriteRecipeToken = {\n      id,\n      type: 'bebida',\n      area: '',\n      category: strCategory,\n      alcoholicOrNot: strAlcoholic,\n      name: strDrink,\n      image: strDrinkThumb,\n    };\n    let favoriteRecipes = JSON.parse(localStorage.getItem('favoriteRecipes'));\n    if (favoriteRecipes) {\n      if (favoriteRecipes.every((recipe) => recipe.id !== favoriteRecipeToken.id)) {\n        favoriteRecipes.push(favoriteRecipeToken);\n        document.getElementById('fav-btn').setAttribute('src', blackHeartIcon);\n      } else {\n        favoriteRecipes = favoriteRecipes\n          .filter((recipe) => recipe.id !== favoriteRecipeToken.id);\n        document.getElementById('fav-btn').setAttribute('src', whiteHeartIcon);\n      }\n    } else {\n      favoriteRecipes = [favoriteRecipeToken];\n      document.getElementById('fav-btn').setAttribute('src', blackHeartIcon);\n    }\n    localStorage.setItem('favoriteRecipes', JSON.stringify(favoriteRecipes));\n    if (Object.values(favoriteRecipes).length === 0) {\n      localStorage.removeItem('favoriteRecipes');\n    }\n  };\n  return (\n    <div onChange={ isDisabled } className=\"in-progress\">\n      { redirect.should && <Redirect to={ redirect.path } />}\n      <HeaderWithoutSearch>Receita em progresso</HeaderWithoutSearch>\n      <div className=\"img-ingredients\">\n        <img\n          src={ drinkDetails.strDrinkThumb }\n          alt=\"imagem da bebida\"\n          data-testid=\"recipe-photo\"\n          className=\"in-progress-pic\"\n        />\n        <div className='recipe-detail'>\n          <div className=\"detail-card\">\n            <h2 data-testid=\"recipe-title\">{ drinkDetails.strDrink }</h2>\n            <div className=\"details-btn-div\">\n              <ShareBtn id={ id } type=\"bebida\" />\n              <Button\n                className=\"favorite-btn\"\n                variant=\"danger\"\n                type=\"button\"\n                onClick={ setFavorite }\n              >\n                <img\n                  id=\"fav-btn\"\n                  className=\"icon\"\n                  src={ whiteHeartIcon }\n                  alt=\"favoritar\"\n                  data-testid=\"favorite-btn\"\n                />\n              </Button>\n            </div>\n          </div>\n          <p data-testid=\"recipe-category\">\n            <span>Categoria: </span>\n            { drinkDetails.strAlcoholic }\n          </p>\n          <div className=\"list-ingredients\">\n            <h4>Ingredientes</h4>\n            <ul>\n              {listIngredients.map((ingredient, index) => (\n                <li\n                  key={ index }\n                  data-testid={ `${index}-ingredient-step` }\n                  className=\"in-progress-list\"\n                >\n                  <Form.Group className=\"mb-3\" controlId={ `${index}-ingredient-step` }>\n                    <Form.Check\n                      type=\"checkbox\"\n                      id={ `${index}-ingredient-step` }\n                      label={ filterAlcoohol[index] ? (\n                        `${ingredient[1]} - ${filterAlcoohol[index][1]}`\n                      ) : (ingredient[1]) }\n                      onChange={ ({ target }) => {\n                        const label = target.parentElement;\n                        progressRecipe(label.innerText);\n                        if (target.checked) {\n                          label.style.textDecoration = 'line-through';\n                        } else if (!target.checked) {\n                          target.defaultChecked = false;\n                          label.style.textDecoration = 'none';\n                        }\n                      } }\n                    />\n                  </Form.Group>\n                </li>\n              ))}\n            </ul>\n          </div>\n        </div>\n      </div>\n      <strong>Instruções: </strong>\n      <p\n        className=\"instructions\"\n        data-testid=\"instructions\"\n      >\n        { drinkDetails.strInstructions }\n      </p>\n      <Button\n        disabled={ disabled }\n        type=\"button\"\n        data-testid=\"finish-recipe-btn\"\n        className=\"finishRecipe\"\n        onClick={ finishRecipe }\n      >\n        Finalizar Receita\n      </Button>\n    </div>\n  );\n}\nexport default DrinksInProgress;\n"]},"metadata":{},"sourceType":"module"}